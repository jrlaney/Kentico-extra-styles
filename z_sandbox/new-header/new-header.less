@import '../../settings.less';

.uppercase {
    text-transform:uppercase;
    letter-spacing:0.1em;
}

.transition-open(@args) {
    -webkit-transition: @args;
    transition: @args;
}
.transition-delay(@delay: 0.2s) {
    -moz-transition-delay: @delay;
    -webkit-transition-delay: @delay;
    transition-delay: @delay;
}

//custom animation beziers
@ease-bezier:     cubic-bezier(.86,.01,.23,1);
@ease-out-bezier: cubic-bezier(.2,0,.03,1);
@ease-in-bezier:  cubic-bezier(.98,0,.76,1);

//JUST FOR THE SAMPLE
//header, nav, .top-banner {display:none!important;}

//ADD SPACERS TO THE TOP TO ACCOUNT FOR FIXED ELEMENTS IN PREVIEW MODE AND IN THE CMS
@preview-mode-spacer:17px;
@cms-viewer-spacer:110px;

#container {background-color:@white;}
body {position:relative;}
.CMS-preview-mode #primary-menu,
.CMS-preview-mode.menu-opened #header {
    top:@preview-mode-spacer;
    //@media @medium {top:@preview-mode-spacer - 18;}
}
.CMS-preview-mode #primary-menu {
    height: ~"calc(100% - @{preview-mode-spacer})";
    //@media @medium {height: ~"calc(100% - @{preview-mode-spacer} + 18px)";}
}
.cms-bootstrap .CMS-preview-mode #primary-menu,
.cms-bootstrap .CMS-preview-mode.menu-opened #header {top:@cms-viewer-spacer;}
.cms-bootstrap .CMS-preview-mode #primary-menu {height: ~"calc(100% - @{cms-viewer-spacer})";}

//get rid of double scroll bar and add padding so the content doesnt pop up when the header goes fixed
body.menu-opened {
    overflow:hidden;
    padding-top:60px;
}




//HEADER STYLES
@header-z-index: 900;
#header {
    display:block; z-index:@header-z-index;
    overflow:hidden;
    width:100%; height:60px;
    background-color:@white;

    .prevent-highlight;
    font-family:@myriad-pro;
    font-style:normal; font-weight:400;
    font-size:14px; line-height:20px;
    .uppercase;

    //animation for menu opening
    position:relative;
    .transition-open(~"all 0.2s ease-out 0.2s");
    .menu-opened & {
        position:fixed;
        background-color:@red;
        top:0; left:0;
        .transition-open(~"all 0.2s ease-out 0s");
        @media @medium {background-color:transparent; border-bottom:none;}
    }

    //centered row with breakpoints
    .header-wrapper {
        .display(flex);
        .flex(0, 1, auto);
        .flex-direction(row);
        .flex-wrap(nowrap);
        .justify-content(flex-end);
        .align-items(center);
        margin-left:auto; margin-right:auto;
        padding:0 15px;
        @media @medium {max-width:@small-breakpoint; padding-right:0;}
        @media @large {max-width:@medium-breakpoint;}
        @media @xlarge {max-width:@large-breakpoint;}
    }
    .trial-button,
    .primary-menu-button,
    .logo-col {.flex(0, 0, auto);}
    .logo-col {
        position:relative;
        margin-right:auto;
        .logo-link {
            display:block; position:relative; z-index:2;
            .logo-img {
                display:block;
                width:180px;
                fill-rule:evenodd;
                @media @large {width:220px;}

                //animations for menu opening
                fill: @red;
                .transition-open(all 0.2s ease-out 0.2s);
                .menu-opened & {
                    fill:@white;
                    .transition-open(all 0.2s ease-out 0s);
                }
            }
        }
        .tagline {
            display:none;
            @media @medium {
                position:absolute; display:inline-block; z-index:1;
                width:auto;
                left:~"calc(100% + 15px)"; top:50%;
                .translateY(-50%);
                padding:0; margin:0;
                white-space:nowrap;
                cursor:default;

                //animations for menu opening
                color:@monsoon; opacity:1;
                .transition-open(all 0.2s ease-out 0.2s);
                .menu-opened & {
                    opacity:0; .translateY(-100%);
                    .transition-open(all 0.2s ease-out 0s);
                }
            }
        }//end tagline
    }//end logo col
    .trial-button {
        display:none;
        @media @medium {
            display:inline-block;
            margin:0px!important;
            border:none!important;
            .transition(.2s, ease-out, all, 0.2s);
            .menu-opened & {
                background-color:@red;
                color:@white;
                &:hover {background-color:@light-red;}
                .transition(.2s, ease-out, all, 0.3s);
            }
        }
    }
    .primary-menu-button {
        position:relative;
        cursor:pointer;
        height:60px; width:45px;
        @media @medium {
            width:100px;
            &:hover {
                .text.closed {color:@red;}
                .menu-toggle .line,
                .menu-opened & .menu-toggle .line {background-color:@red;}
            }
        }
        .text {
            display:none;
            @media @medium {
                display:block; position:absolute;
                top:20px; left:15px;
                color:@monsoon;
                &.closed {
                    opacity:1; .translateY(0); color:@monsoon;
                    .transition-open(~"opacity 0.2s ease-out 0.5s, transform 0.2s ease-out 0.5s, color 0.2s ease-out 0s");
                    .menu-opened & {
                        opacity:0; transform:translateY(-10px);
                        .transition-open(all 0.2s ease-out 0s);
                    }
                }
                &.opened {
                    opacity:0; transform:translateY(10px); color:@white;
                    .transition-open(all 0.2s ease-out 0s);
                    .menu-opened & {
                        opacity:1; transform:translateY(0);
                        .transition-open(all 0.2s ease-out 0.7s);
                    }
                }
            }
        }//end text
        .menu-toggle {
            display:block; position:absolute;
            right:10px; top:50%; margin-top:-7px;
            width:24px; height:14px;
            .line {
                display:block; position:absolute;
                height:2px; width:100%;
                top:50%; margin-top:-1px;
                left:50%; margin-left:-12px;
                transform-origin: center center;
                &.one {margin-top:-6px;}
                &.three {margin-top:4px;}

                //animations for menu opening
                background-color:@charcoal;
                .transition-open(~"background 0.2s ease-out 0s, transform 0.4s ease-out 0.5s, opacity 0.4s ease-out 0.5s, margin 0.2s ease-out 0.5s");
                &.two {
                    .transition-open(~"background 0.2s ease-out 0s, transform 0.4s ease-out 0.3s, opacity 0.4s ease-out 0.5s, margin 0.2s ease-out 0.5s");
                }
                //animation for the lines when the menu is opened
                .menu-opened & {
                    background-color:@white;
                    &.one {.rotation(45deg); margin-top:-1px;}
                    &.two {opacity:0; .translateX(25px);}
                    &.three {.rotation(-45deg); margin-top:-1px;}
                }
            }//end menu toggle line
        }//end menu toggle
    }//end primary menu button
}
//when the menu is opened, make it so the site content cant scroll
@media @medium {body.menu-opened {overflow:hidden;}}



#primary-menu {
    display:block; position:fixed;
    overflow:hidden;
    width:100%; height:100%;
    top:0; left:0; bottom:0; right:0;

    font-family:@myriad-pro;
    font-size:18px; line-height:24px;
    font-style:normal; font-weight:300;
    color:@white;
    //padding-top:60px;

    //animation to stack the nav on top of the content when opened
    z-index:-2; opacity:0;
    .transition-open(~"z-index 0.5s step-end, opacity 0.5s step-end 0s");
    .menu-opened & {
        z-index:@header-z-index - 1; opacity:1;
        .transition-open(~"z-index 0s step-start, opacity 0s step-start");
    }

    @media @medium {
        .display(flex);
        .flex(1, 1, auto);
        .flex-direction(column);
        .flex-wrap(nowrap);
    	.align-items(center);
    	.justify-content(center);
    }

    .node-navigation {
        width:100%; min-height:100%;
        overflow:hidden;
        overflow-y:auto;
        @media @medium {
            .display(flex);
            .flex(1, 1, auto);
            .align-items(stretch);

            padding:0;
            margin-left:auto; margin-right:auto;
            position:relative; z-index:3;

            max-width:@small-breakpoint;

        }//desktop size node panel
        @media @large {max-width:@medium-breakpoint;}
        @media @xlarge {max-width:@large-breakpoint;}
    }//end node-navigation

    .node-panel {
        .display(flex);
        .flex(0, 1, auto);
        .flex-direction(column);
        .flex-wrap(nowrap);
    	.align-items(flex-start);
        position:relative;
        width:100%; min-height:100%;
        padding-top:60px;
        &.level-1 {z-index:2; padding-top:80px;}

        //animate in when menu is opened
        opacity:0; .translateX(-100%);
        .transition-open(~"opacity 0.2s ease-in 0s, transform 0.3s ease-out 0s");
        .menu-opened & {
            opacity:1; .translateX(0);
            .transition-open(~"opacity 0.3s ease-in 0.3s, transform 0.3s ease-in 0.3s");
        }

        @media @medium {
            width:30%;
            &.level-1 {padding-top:80px;}
            //animate in when menu is opened
            .translateX(-10%);
            .menu-opened & {
                .translateX(0);
            }
        }

        //this forces the child panels to be under the parent panel when sliding out
        //also animate in the background after the overall menu animation plays
        &:after {
            display:block; position:absolute; z-index:-1;
            content:'';
            top:0; left:0;
            height:100%; width:100%;
            background-color:lighten(@black, 10%);
            .box-shadow(1px 1px 10px fade(@pure-black, 40%));

            opacity:0;
            .transition-open(~"opacity 0s ease-in 0s, background-color 0.2s ease-out 0s");
            .menu-opened & {
                opacity:1;
                .transition-open(~"opacity 0.2s ease-in 0.5s, background-color 0.2s ease-out 0s");
            }
        }
        &.level-2 {z-index:-2; &:after{background-color:lighten(@black, 5%);}}
        &.level-3 {z-index:-3; &:after{background-color:@black; .box-shadow(none);}}

        //label for the list of links below, text copy of selected left item
        .node-label {
            position:relative; overflow:hidden;
            padding:30px 30px 15px 30px;
            color:@gray;
            line-height:1em;
            .uppercase;
            font-weight:400;
            white-space:nowrap;
            &:after {
                display:block; position:relative;
                content:'';
                height:3px; width:50px;
                margin-top:15px;
                background-color:@gray;
            }
        }
        .red.parent-node .node-label:after {background-color:@red;}
        .orange.parent-node .node-label:after {background-color:@orange;}
        .green.parent-node .node-label:after {background-color:@green;}
        .blue.parent-node .node-label:after {background-color:@blue;}
        .navy-blue.parent-node .node-label:after {background-color:@navy-blue;}

        //for all the sub links inside the node panels
        .sub-link {
            display:block; position:relative;
            cursor:pointer;
            color:@white;
            padding:0.7vh 30px;
            .prevent-highlight;

            //animations
            opacity:0.5;
            .transition;
            &:hover {opacity:1;}
        }
        //special styles for the first level panel
        &.level-1 > .parent-node {
            > .sub-link {
                font-size:40px; line-height:1em;
                padding:1.2vh 50px 1.2vh 15px;
                .section-summary {
                    display:block; overflow:hidden;
                    font-size:14px; line-height:18px;
                    .uppercase; letter-spacing:0.1em;
                    font-weight:400;

                    //animations
                    max-height:0; opacity:0; padding-top:0;
                    .transition;
                }
            }
            &.active > .sub-link .section-summary {max-height:100%; opacity:1; padding-top:5px;}
        }

        //position the sub level panels to the right of the main stack
        &.level-2, &.level-3 {
            position:absolute;
            left:100%; top:0;
            height:100%;

            //give sub links in level 2-3 a dark highlight on hover
            .sub-link {
                .transition;
                &:hover {background-color:fade(@pure-black, 15%);}
            }
        }
        &.level-2 {
            width:75%;
            .parent-node.active > .sub-link {background-color:lighten(@black, 10%);}
            .parent-node.active > .sub-link:after {border-left-color:lighten(@black, 10%);}
        }
        .red.parent-node .parent-node.active > .sub-link {
            background-color:@red;
            &:after {border-left-color:@red;}
        }
        .orange.parent-node .parent-node.active > .sub-link {
            background-color:@orange;
            &:after {border-left-color:@orange;}
        }
        .green.parent-node .parent-node.active > .sub-link {
            background-color:@green;
            &:after {border-left-color:@green;}
        }
        .blue.parent-node .parent-node.active > .sub-link {
            background-color:@blue;
            &:after {border-left-color:@blue;}
        }
        .navy-blue.parent-node .parent-node.active > .sub-link {
            background-color:@navy-blue;
            &:after {border-left-color:@navy-blue;}
        }
        &.level-3 {width:100%;}
        //end level-2 and level-3 node panel adjustments

        //special styles for search and contact cols
        .search-col .node-panel.level-2,
        .contact-col .node-panel.level-2 {
            width:~"calc(@{large-breakpoint} - 100%)";
            &:after {background:@black; .box-shadow(none);}
        }
        .search-col {
            .search-info {
                .display(flex);
                .flex(0, 1, auto);
                .flex-direction(column);
                .flex-wrap(nowrap);
            	.justify-content(center);
                padding:0 30px;
                height:~"calc(100% - 50vh)"
            }
            .input-group {
                .display(flex);
                .flex-direction(row);
                .flex-wrap(wrap);
                .input-group-label {.flex(1, 1, 100%); width:100%; margin-bottom:5px;}
                .input-group-field > [type='search'] {
                    margin-top:0;
                    color:@gray;
                    background-color:transparent;
                    background-image:url(/getmedia/bd1e9ace-a8ed-470d-923f-372d4ef057e3/magnifying-glass_MEDIUM);
                    padding:0;
                    border-width:0 0 1px 0;
                    &:focus {padding:1em 3em 1em 1em; background-color:darken(@black, 10%);}
                }
            }
        }
        .contact-col .contact-info {
            .display(flex);
            .flex-direction(row);
            .flex-wrap(wrap);
            padding:1vh 15px;
        }

        //animations for opening the level 2-3 panels in each node
        .parent-node {
    		.flex(0, 1, auto);
    		width:100%;

            //for the panels sliding out
            > .node-panel {
                overflow:hidden;
                opacity:0;
                .translateX(-50%);
                max-height:0;
                .transition-open(~"all 0.2s ease-out 0s, max-height 0.2s step-end");
            }
            &.active > .node-panel {
                display:table;
                opacity:1;
                overflow:visible;
                .translateX(0);
                max-height:100%;
                .transition-open(~"all 0.2s ease-out 0.2s, max-height 0.2s step-start");
            }

            &.active > .sub-link {opacity:1;}

            //for the triangle on the right
            > .sub-link:after {
                display:block; position:absolute;
                content:'';
                top:50%; right:15px;
                width:0; height:0;
                border-top:7px solid transparent;
                border-bottom:7px solid transparent;
                border-left:7px solid @white;

                .translate(0, -50%);
                //opacity:0.5;
                .transition;
            }
            > .sub-link:hover:after {opacity:1;}
            &.active > .sub-link:after {
                border-top-width:10px;
                border-bottom-width:10px;
                border-left-width:10px;
                opacity:1; .translate(25px, -50%);
            }
        }//end parent node animations and states

        //make the level 1 triangle bigger
        &.level-1 > .parent-node {
            > .sub-link:after {
                border-top-width:10px;
                border-bottom-width:10px;
                border-left-width:10px;
            }
            &.active > .sub-link:after {
                border-top-width:15px;
                border-bottom-width:15px;
                border-left-width:15px;
                border-left-color:lighten(@black, 10%);
                .translate(30px, -50%);
            }
            &.red.active > .sub-link:after {border-left-color:@red;}
            &.orange.active > .sub-link:after {border-left-color:@orange;}
            &.green.active > .sub-link:after {border-left-color:@green;}
            &.blue.active > .sub-link:after {border-left-color:@blue;}
            &.navy-blue.active > .sub-link:after {border-left-color:@navy-blue;}
        }

    }//end node-panel

    .menu-footer {
		.flex(0, 1, auto);
        position:relative; z-index:3;
        width:100%;
        padding:0 20px 20px 20px; margin-top:auto;
        text-align:left;

        .line {margin-bottom:0; opacity:0.7;}
        .quick-links {
            display:block; margin-bottom:15px;
            .footer-link {
                display:inline-block; position:relative;
                font-weight:400;
                padding:10px 9px 10px 5px;
                color:@white;
                font-size:16px; line-height:1em;
                &:first-child {padding-left:0;}
                &:last-child {padding-right:10px; &:after{display:none;}}
                &:hover {color:fade(@white, 100%);}
                &:after {
                    display:block; position:absolute;
                    content:'';
                    top:50%; right:0;
                    height:40%; width:1px;
                    background-color:@white;
                    .translateY(-50%);
                    opacity:0.7;
                }
            }
        }//end quick links
        .social-links {
            display:inline-block;
            .icon {padding:10px 3px;}
        }
        .dropup {
            text-align:left;
            width:100%;
            background-color:fade(@pure-black, 20%);
            .transition;
            &:hover {background-color:fade(@pure-black, 25%);}
            &.open {background-color:fade(@pure-black, 30%);}
            .dropdown-toggle {
                color:@white; width:100%; background-color:transparent!important;
            }
            .dropdown-menu {background-color:darken(@black, 5%);}
        }
    }//end menu-footer

    .primary-menu-background {
        display:block; position:absolute; z-index:1;
        width:100%; height:100%;
        top:0; left:0;
        background-color:@black;

        //animations
        .transition-open(~"opacity 0.2s ease-in 0.2s, transform 0.2s ease-out 0.2s");
        opacity:0; .translateX(-100%);
        .menu-opened & {
            opacity:1;
            .translateX(0%);
            .transition-open(~"opacity 0.3s ease-in 0s, transform 0.3s ease-in 0s");
        }
        @media @medium {
            background-color:transparent;
            //for the header part
            &:after, &:before {
                position:absolute; z-index:0;
                content:'';
                height:100%; width:100%;
                top:0; bottom:0;
            }
            &:after {
                right:50%;
                background-color:lighten(@black, 10%);

                //animate in when menu is opened
                opacity:0; .translateX(~"calc("-@large-breakpoint / 5 ~" - 20%)");
                @media @large {}
                .transition-open(~"opacity 0.2s ease-in 0.2s, transform 0.2s ease-out 0.2s, background-color 0.2s ease-out 0s");
                .menu-opened & {
                    opacity:1; .translateX(-@large-breakpoint / 5);
                    .transition-open(~"opacity 0.3s ease-in 0s, transform 0.3s ease-in 0s, background-color 0.2s ease-out 0s");
                }
            }
            &:before {
                left:50%;
                //background-color:darken(@black, 10%);
                background-color:@black;
                //border-bottom:1px solid fade(@white, 40%);

                //animate in when menu is opened
                opacity:0; .translateX(~"calc("-@large-breakpoint / 5 ~"+ 20%)");
                .transition-open(~"opacity 0.2s ease-in 0.2s, transform 0.3s ease-out 0.2s");
                .menu-opened & {
                    opacity:1; .translateX(-@large-breakpoint / 5);
                    .transition-open(~"opacity 0.3s ease-in 0s, transform 0.3s ease-in 0s");
                }
            }
        }
    }//end primary menu background

    //color-change stuff for background panels
    @media @medium {
        &.red {
            .node-panel.level-1:after {background-color:@red;}
            .menu-footer .dropup .dropdown-menu {background-color:darken(@red, 20%);}
            .primary-menu-background:after {background-color:@red;}
        }
        &.orange {
            .node-panel.level-1:after {background-color:@orange;}
            .menu-footer .dropup .dropdown-menu {background-color:darken(@orange, 20%);}
            .primary-menu-background:after {background-color:@orange;}
        }
        &.green {
            .node-panel.level-1:after {background-color:@green;}
            .menu-footer .dropup .dropdown-menu {background-color:darken(@green, 10%);}
            .primary-menu-background:after {background-color:@green;}
        }
        &.blue {
            .node-panel.level-1:after {background-color:@blue;}
            .menu-footer .dropup .dropdown-menu {background-color:darken(@blue, 20%);}
            .primary-menu-background:after {background-color:@blue;}
        }
        &.navy-blue {
            .node-panel.level-1:after {background-color:@navy-blue;}
            .menu-footer .dropup .dropdown-menu {background-color:darken(@navy-blue, 10%);}
            .primary-menu-background:after {background-color:@navy-blue;}
        }
    }
}
