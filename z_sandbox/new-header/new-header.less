@import '../../settings.less';

.transition-open(@args) {
    -webkit-transition: @args;
    transition: @args;
}
.transition-delay(@delay: 0.2s) {
    -moz-transition-delay: @delay;
    -webkit-transition-delay: @delay;
    transition-delay: @delay;
}

//animation beziers
@ease-bezier:     cubic-bezier(.86,.01,.23,1);
@ease-out-bezier: cubic-bezier(.2,0,.03,1);
@ease-in-bezier:  cubic-bezier(.98,0,.76,1);

//JUST FOR THE SAMPLE
//header, nav, .top-banner {display:none!important;}

//ADD SPACERS TO THE TOP TO ACCOUNT FOR FIXED ELEMENTS IN PREVIEW MODE AND IN THE CMS
@preview-mode-spacer:47px;
@cms-viewer-spacer:110px;

#container {background-color:@white;}
body {position:relative;}
.CMS-preview-mode #primary-menu,
.CMS-preview-mode.menu-opened #header {
    top:@preview-mode-spacer;
    @media @medium {top:@preview-mode-spacer - 18;}
}
.CMS-preview-mode #primary-menu {
    height: ~"calc(100% - @{preview-mode-spacer})";
    @media @medium {height: ~"calc(100% - @{preview-mode-spacer} + 18px)";}
}
.cms-bootstrap #primary-menu,
.cms-bootstrap.menu-opened #header {top:@cms-viewer-spacer;}
.cms-bootstrap #primary-menu {height: ~"calc(100% - @{cms-viewer-spacer})";}
body.menu-opened {
    overflow:hidden;
    padding-top:60px;
}

@header-z-index: 900;
/* HEADER AND NAV STYLES */
#header {
    display:block; z-index:@header-z-index;
    overflow:hidden;
    width:100%; height:60px;
    background-color:@white;
    .prevent-highlight;
    font-family:@myriad-pro;
    font-style:normal; font-weight:400;
    font-size:14px; line-height:20px;
    .uppercase;

    //animation for menu opening
    position:relative;
    .transition-open(~"all 0.2s ease-out 0.2s");
    .menu-opened & {
        position:fixed;
        background-color:transparent;
        top:0; left:0;
        .transition-open(~"all 0.2s ease-out 0s");
    }

    //centered row with breakpoints
    .header-wrapper {
        .display(flex);
        .flex(0, 1, auto);
        .flex-direction(row);
        .flex-wrap(nowrap);
        .justify-content(flex-end);
        .align-items(center);
        margin-left:auto; margin-right:auto;
        @media @medium {max-width:@small-breakpoint;}
        @media @large {max-width:@medium-breakpoint;}
        @media @xlarge {max-width:@large-breakpoint;}
    }
    .trial-button,
    .primary-menu-button,
    .logo-col {.flex(0, 0, auto);}
    .logo-col {
        position:relative;
        margin-right:auto;
        .logo-link {
            display:block; position:relative; z-index:2;
            padding-left:15px;
            .logo-img {
                display:block;
                width:180px;
                fill-rule:evenodd;
                @media @large {width:220px;}

                //animations for menu opening
                fill: @red;
                .transition-open(all 0.2s ease-out 0.2s);
                .menu-opened & {
                    fill:@white;
                    .transition-open(all 0.2s ease-out 0s);
                }
            }
        }
        .tagline {
            display:none;
            @media @medium {
                position:absolute; display:inline-block;
                width:auto;
                left:~"calc(100% + 15px)"; top:50%;
                .translateY(-50%);
                padding:0; margin:0;
                white-space:nowrap;
                cursor:default;

                //animations for menu opening
                color:@monsoon;
                .transition-open(all 0.2s ease-out 0.2s);
                .menu-opened & {
                    color:@white;
                    .transition-open(all 0.2s ease-out 0s);
                }
            }
        }//end tagline
    }//end logo col
    .trial-button {
        margin:0px!important;
        border:none!important;
        @media @medium {
            .transition(.2s, ease-out, all, 0.2s);
            .menu-opened & {
                background-color:@red;
                color:@white;
                &:hover {background-color:@light-red;}
                .transition(.2s, ease-out, all, 0.3s);
            }
        }
    }
    .primary-menu-button {
        position:relative;
        cursor:pointer;
        height:60px; width:100px;
        @media @medium {
            &:hover {
                .text.closed {color:@red;}
                .menu-toggle .line,
                .menu-opened & .menu-toggle .line {background-color:@red;}
            }
        }
        .text {
            display:block; position:absolute;
            top:20px; left:15px;
            color:@monsoon;
            &.closed {
                opacity:1; .translateY(0); color:@monsoon;
                .transition-open(~"opacity 0.2s ease-out 0.5s, transform 0.2s ease-out 0.5s, color 0.2s ease-out 0s");
                .menu-opened & {
                    opacity:0; transform:translateY(-10px);
                    .transition-open(all 0.2s ease-out 0s);
                }
            }
            &.opened {
                opacity:0; transform:translateY(10px); color:@white;
                .transition-open(all 0.2s ease-out 0s);
                .menu-opened & {
                    opacity:1; transform:translateY(0);
                    .transition-open(all 0.2s ease-out 0.7s);
                }
            }
        }//end text
        .menu-toggle {
            display:block; position:absolute;
            right:10px; top:50%; margin-top:-7px;
            width:24px; height:14px;
            .line {
                display:block; position:absolute;
                height:2px; width:100%;
                top:50%; margin-top:-1px;
                left:50%; margin-left:-12px;
                transform-origin: center center;
                &.one {margin-top:-6px;}
                &.three {margin-top:4px;}

                //animations for menu opening
                background-color:@charcoal;
                .transition-open(~"background 0.2s ease-out 0s, transform 0.4s ease-out 0.5s, opacity 0.4s ease-out 0.5s, margin 0.2s ease-out 0.5s");
                &.two {
                    .transition-open(~"background 0.2s ease-out 0s, transform 0.4s ease-out 0.3s, opacity 0.4s ease-out 0.5s, margin 0.2s ease-out 0.5s");
                }
                //animation for the lines when the menu is opened
                .menu-opened & {
                    background-color:@white;
                    &.one {.rotation(45deg); margin-top:-1px;}
                    &.two {opacity:0; .translateX(25px);}
                    &.three {.rotation(-45deg); margin-top:-1px;}
                }
            }//end menu toggle line
        }//end menu toggle
    }//end primary menu button
    @media @small-only {
        .logo-col .tagline,
        .trial-button {display:none;}
    }
}
//when the menu is opened, make it so the site content cant scroll
@media @medium {body.menu-opened {overflow:hidden;}}



#primary-menu {
    display:block; position:fixed;
    overflow:hidden;
    width:100%; height:100%;
    top:0; left:0; bottom:0; right:0;
    font-family:@myriad-pro;
    font-style:normal; font-weight:300;
    color:@white;
    padding-top:60px;

    //animation to stack the nav on top of the content when opened
    z-index:-2; opacity:0;
    .transition-open(~"z-index 0.5s step-end, opacity 0.5s step-end 0s");
    .menu-opened & {
        z-index:@header-z-index - 1; opacity:1;
        .transition-open(~"z-index 0s step-start, opacity 0s step-start");
    }

    @media @medium {
        .display(flex);
        .flex(1, 1, auto);
        .flex-direction(column);
        .flex-wrap(nowrap);
    	.align-items(center);
    	.justify-content(center);
    }
    .node-navigation {
        @media @medium {
            .display(flex);
            .flex(1, 1, auto);
    		width:100%; overflow-y:auto;

            padding:0;
            margin-left:auto; margin-right:auto;
            position:relative; z-index:3;

            max-width:@small-breakpoint;


            //animate in when menu is opened
            opacity:0; .translateX(-10%);
            .transition-open(~"opacity 0.2s ease-in 0s, transform 0.3s ease-out 0s");
            .menu-opened & {
                opacity:1; .translateX(0);
                .transition-open(~"opacity 0.3s ease-in 0.3s, transform 0.3s ease-in 0.3s");
            }

        }//desktop size node panel
        @media @large {max-width:@medium-breakpoint;}
        @media @xlarge {max-width:@large-breakpoint;}
    }//end node-navigation

    .node-panel {
        .display(flex);
        .flex(0, 1, auto);
        .flex-direction(column);
        .flex-wrap(wrap);
    	.align-items(flex-start);
        position:relative;
        width:33.33%;

        //this forces the child panels to be under the parent panel when sliding out
        &:after {
            display:block; position:absolute; z-index:-1;
            content:'';
            top:0; left:0;
            height:100%; width:100%;
            background-color:@red;
            //border-right:1px solid fade(@white, 40%);
        }
        &.level-2 {
            z-index:-2;
            &:after {background-color:@black;}
        }
        &.level-3 {
            z-index:-3;
            &:after {background-color:@black; border-right:none;}
        }

        //label for the list of links below, text copy of selected left item
        .node-label {
            position:relative; overflow:hidden;
            font-size:30px; line-height:1em;
            opacity:0.2;
            text-shadow: 0 0 1px @pure-black;
            padding:30px 20px;
            white-space:nowrap;
        }

        //for all the sub links inside the node panels
        .sub-link {
            display:block; position:relative;
            cursor:pointer;
            color:@white;
            padding:1vh 50px 1vh 20px;
            .prevent-highlight;

            //animations
            opacity:0.5;
            .transition;
            &:hover {opacity:1;}
        }

        //position the sub level panels to the right of the main stack
        &.level-2, &.level-3 {
            position:absolute;
            left:100%; top:0;
            max-width:100%; min-width:70%;
            height:100%;
        }//end level-2 and level-3 node panels

        //animations for opening the level 2-3 panels in each node
        .parent-node {
    		.flex(0, 1, auto);
    		width:100%;
            > .node-panel {
                overflow:hidden;
                opacity:0;
                .translateX(-50%);
                max-height:0;
                padding:0;
                .transition-open(~"all 0.2s ease-out 0s, max-height 0.2s step-end");
            }
            &.active > .node-panel {
                display:table;
                opacity:1;
                overflow:visible;
                .translateX(0);
                max-height:100%;
                .transition-open(~"all 0.2s ease-out 0.2s, max-height 0.2s step-start");
            }

            > .sub-link:after {
                display:block; position:absolute;
                content:'';
                top:50%; right:15px;
                width:0; height:0;
                border-top:7px solid transparent;
                border-bottom:7px solid transparent;
                border-left:7px solid @white;

                .translate(0, -50%);
                opacity:0.3;
                .transition;
            }
            > .sub-link:hover:after    {opacity:1;}
            &.active > .sub-link       {opacity:1;}
            &.active > .sub-link:after {opacity:1; .translate(22px, -50%);}
        }//end parent node animations and states
    }//end node-panel

    .menu-footer {
		.flex(0, 1, auto);
		width:100%;

        position:relative; z-index:3;
        margin-left:auto; margin-right:auto; margin-top:auto;
        width:100%;
        padding:20px;

        .button {margin-bottom:0px;}
        .dropup {
            .align-self(flex-end);
            margin-left:auto;
        }
        .footer-link {
            display:inline-block;
            padding:10px;
            color:@white;
        }
    }//end menu-footer

    .primary-menu-background {
        display:block; position:absolute; z-index:1;
        width:100%; height:100%;
        top:0; left:0;
        // //background-color:@black;
        // .angled-gradient(darken(@black, 10%),lighten(@black, 10%), darken(@black, 10%));
        //
        // //animations
        // opacity:0; .translateX(-100%);
        // .transition-open(~"opacity 0.2s ease-in 0.2s, transform 0.3s @{ease-in-bezier} 0s");
        // .menu-opened & {
        //     opacity:1; .translateX(0);
        //     .transition-open(~"opacity 0.2s ease-in 0s, transform 0.3s @{ease-in-bezier} 0s");
        // }

        //for the header part
        &:after, &:before {
            position:absolute; z-index:0;
            content:'';
            height:100%; width:100%;
            top:0; bottom:0;
        }
        &:after {
            right:50%;
            //background-color:darken(@black, 10%);
            background-color:@red;
            //border-bottom:1px solid fade(@white, 40%);

            //animate in when menu is opened
            opacity:0; .translateX(~"calc(-200px + -20%)");
            .transition-open(~"opacity 0.2s ease-in 0s, transform 0.3s ease-out 0s");
            .menu-opened & {
                opacity:1; .translateX(-200px);
                .transition-open(~"opacity 0.3s ease-in 0s, transform 0.3s ease-in 0s");
            }
        }
        &:before {
            left:50%;
            //background-color:darken(@black, 10%);
            background-color:@black;
            //border-bottom:1px solid fade(@white, 40%);

            //animate in when menu is opened
            opacity:0; .translateX(~"calc(-200px + 20%)");
            .transition-open(~"opacity 0.2s ease-in 0s, transform 0.3s ease-out 0s");
            .menu-opened & {
                opacity:1; .translateX(-200px);
                .transition-open(~"opacity 0.3s ease-in 0s, transform 0.3s ease-in 0s");
            }
        }
    }//end primary menu background
}
